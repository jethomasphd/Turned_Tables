<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tables Turned</title>
  <meta name="description" content="Search 37 million medical research papers in plain English. AI translates the jargon, you curate the evidence, every claim cites its source. The public record, returned to the public.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Crimson+Pro:ital,wght@0,300;0,400;0,500;1,300;1,400&family=IBM+Plex+Mono:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- ═══ CINEMATIC INTRO ═══ -->
  <div id="intro">
    <div class="intro-glow"></div>
    <div id="skip-intro">skip</div>

    <div class="intro-stage">
      <div class="intro-card" id="intro-card">

        <!-- Front face: typewriter -->
        <div class="intro-card-front">
          <div class="intro-lines" id="intro-lines">
            <p id="ln1"></p>
            <p id="ln2"></p>
            <p id="ln3" class="mt"></p>
            <p id="ln4"></p>
            <p id="ln5" class="mt accent"></p>
          </div>
          <button id="flip-btn" class="flip-btn hidden">Flip the Tables</button>
        </div>

        <!-- Back face: logo reveal -->
        <div class="intro-card-back">
          <div class="sigil-back">&#9674; &#9672; &#9674;</div>
          <h1 class="title-back">Tables Turned</h1>
          <p class="sub-back">The Commons Table</p>
        </div>

      </div>
    </div>
  </div>

  <!-- ═══ THE APP ═══ -->
  <div id="app" class="hidden">

    <header>
      <div class="sigil">&#9674; &#9672; &#9674;</div>
      <h1>Tables Turned</h1>
      <p class="subtitle">The Commons Table</p>
    </header>

    <!-- ═══ WHAT IS THIS? ═══ -->
    <div class="explainer-brief" id="explainer-brief">
      <h2 class="explainer-heading">What is this?</h2>
      <p>The database is called <strong>PubMed</strong>. 37 million medical research papers &mdash; funded by the National Institutes of Health, written by researchers at public universities, peer-reviewed by unpaid scientists, and locked behind journal paywalls charging $35 per paper for work the public already paid for. Tables Turned breaks the glass. It searches PubMed in plain English, translates the jargon, and cites every claim by PubMed ID so you can verify it yourself. Not an answer box. A <em>dialogue</em> with the evidence you already own. <a href="#about-section" id="learn-more-link">Learn how it works &rarr;</a></p>
    </div>

    <!-- ═══ STEP 1: ASK ═══ -->
    <div id="input-view">
      <div class="step-label">Step 1 <span class="step-label-text">Ask your question</span></div>

      <div class="field">
        <label for="q">What are you trying to figure out?</label>
        <textarea id="q" rows="2" placeholder="e.g., Does vitamin D supplementation reduce respiratory infections in children?"></textarea>
      </div>

      <div class="field">
        <label for="ctx">
          What decision does this serve?
          <span class="info-tip" data-tip="Your decision context shapes the synthesis. 'Buying supplements tomorrow' produces different emphasis than 'writing a school paper.' The AI uses this to focus on what matters to you.">?</span>
        </label>
        <input type="text" id="ctx" placeholder="e.g., Deciding whether to give my kid supplements before winter">
      </div>

      <div class="field" id="key-field">
        <label for="key">Anthropic API Key</label>
        <p class="hint">Your key stays in your browser and is only sent to Anthropic's API. Nothing passes through our servers &mdash; we don't have servers. <a href="https://console.anthropic.com/settings/keys" target="_blank">Get a key here.</a></p>
        <input type="password" id="key" placeholder="sk-ant-...">
      </div>

      <!-- Search settings -->
      <details class="search-settings" id="search-settings">
        <summary>Search settings</summary>
        <div class="settings-grid">
          <div class="setting-item">
            <label for="s-depth">Results per query</label>
            <select id="s-depth">
              <option value="5">5 (quick scan)</option>
              <option value="10" selected>10 (standard)</option>
              <option value="25">25 (deep dive)</option>
            </select>
            <span class="setting-note">Applied to each of 3&ndash;4 AI-generated search strategies</span>
          </div>
          <div class="setting-item">
            <label for="s-sort">Sort by</label>
            <select id="s-sort">
              <option value="relevance" selected>Most relevant</option>
              <option value="pub_date">Most recent</option>
            </select>
          </div>
        </div>
      </details>

      <!-- Process transparency callout -->
      <div class="process-callout">
        <div class="process-header">What happens when you search</div>
        <ol class="process-steps">
          <li>Your question is sent to <strong>Claude</strong>, which translates it into optimized medical search terms (MeSH headings, boolean operators, synonyms)</li>
          <li>Those terms query <strong>PubMed</strong>, the world's largest biomedical database (37M+ papers, free, public)</li>
          <li>Each paper is translated into <strong>plain language</strong> so you can decide which ones matter</li>
          <li>You choose papers. AI reads the abstracts and writes a <strong>cited brief</strong> you can download</li>
        </ol>
      </div>

      <button id="search-btn" class="btn-primary">Search the Public Record</button>
      <div id="search-status"></div>

      <!-- Manual entry with pedagogical handhold -->
      <details class="manual-entry">
        <summary>I already have PubMed links</summary>
        <div class="manual-explain">
          <p><strong>PubMed</strong> is the U.S. National Library of Medicine's database of medical research. Every study has a unique PubMed ID (PMID). If you already know which studies you want analyzed, paste their links or IDs below to skip the AI search step.</p>
        </div>
        <div class="field" style="margin-top: 0.75rem;">
          <p class="hint">Paste URLs, PMIDs, or DOIs. One per line.</p>
          <textarea id="links" rows="4" placeholder="https://pubmed.ncbi.nlm.nih.gov/28202713/
28202713
10.1136/bmj.i6583"></textarea>
          <button id="manual-btn" class="btn-secondary" style="margin-top: 0.75rem;">Analyze These Papers</button>
        </div>
      </details>
    </div>

    <!-- ═══ STEP 2: CURATE ═══ -->
    <div id="curate-view" class="hidden">
      <div class="step-label">Step 2 <span class="step-label-text">Choose your papers</span></div>
      <p class="step-desc">We searched PubMed using AI-generated terms. Each paper has been translated into plain language. Check the ones relevant to your question. Uncheck the rest.</p>

      <!-- How we found these -->
      <details class="search-disclosure" id="search-disclosure">
        <summary>How we found these papers</summary>
        <div id="search-terms-display"></div>
        <div class="prompt-peek">
          <details>
            <summary>See the search prompt sent to AI</summary>
            <pre id="search-prompt-display" class="prompt-display"></pre>
          </details>
        </div>
      </details>

      <!-- Search stats -->
      <div class="search-stats" id="search-stats"></div>

      <div class="curate-actions">
        <button id="select-all-btn" class="btn-small">Select all</button>
        <button id="select-none-btn" class="btn-small">Select none</button>
        <span id="curate-count" class="curate-count"></span>
      </div>

      <div id="curate-list"></div>

      <button id="synthesize-btn" class="btn-primary">Read and Synthesize</button>
      <button id="back-to-search" class="btn-back">&#8592; Back to search</button>
    </div>

    <!-- ═══ STEP 3: PROCESSING ═══ -->
    <div id="processing-view" class="hidden">
      <div class="step-label">Step 3 <span class="step-label-text">Reading the record</span></div>
      <div class="processing-sigil">&#9672;</div>
      <div id="proc-status">Preparing synthesis...</div>
      <div id="proc-papers"></div>

      <details class="prompt-peek">
        <summary>See the synthesis prompt</summary>
        <pre id="synth-prompt-display" class="prompt-display"></pre>
      </details>

      <div id="stream-out"></div>
    </div>

    <!-- ═══ STEP 4: RESULTS ═══ -->
    <div id="results-view" class="hidden">
      <div class="step-label">Your Brief</div>
      <div id="brief-out" class="brief-box"></div>

      <details class="prompt-peek" style="margin-bottom: 1rem;">
        <summary>See the prompt that generated this brief</summary>
        <pre id="result-prompt-display" class="prompt-display"></pre>
      </details>

      <div class="provenance-section" id="provenance-section">
        <details>
          <summary>Provenance log</summary>
          <div id="provenance-log" class="provenance-log"></div>
        </details>
      </div>

      <div class="export-row">
        <button class="export-btn primary" id="dl-docx">Download Brief (.docx)</button>
        <button class="export-btn" id="dl-brief">Download Brief (.md)</button>
        <button class="export-btn" id="dl-tablet">Download Tablet (.json)</button>
      </div>
      <button id="again-btn" class="btn-back">&#8592; New question</button>
    </div>

    <!-- ═══ ABOUT & DOCUMENTATION ═══ -->
    <div class="about-section" id="about-section">
      <div class="about-toggle" id="about-toggle">
        <span>About &amp; Documentation</span>
        <span class="toggle-arrow">&#9662;</span>
      </div>
      <div class="about-body hidden" id="about-body">

        <!-- Chapter 1: The Gate and the Garden -->
        <div class="doc-chapter reveal">
          <h2>The Gate and the Garden</h2>
          <p>There is a garden of medical knowledge maintained by the United States government. It is called <strong>PubMed</strong>. 37 million research papers &mdash; clinical trials, systematic reviews, meta-analyses &mdash; funded primarily by the National Institutes of Health. Which means funded by you. Your taxes paid for this research. Your public universities employed the scientists. Your fellow researchers volunteered thousands of unpaid hours to peer-review the manuscripts.</p>
          <p>The abstracts are free. The search is free. The database is technically public.</p>
          <p>Here is what happens next.</p>
          <p>A researcher at a public university, paid with public funds, conducts a study funded by an NIH grant &mdash; also public funds. She writes a paper. She submits it to a journal. Volunteer scientists &mdash; also employed at public universities &mdash; review it for free. The journal publishes it. <strong>The researcher signs over her copyright.</strong> The journal charges $35 to read the paper, or bundles it into a subscription package that costs universities $10,000 to $50,000 per year.</p>
          <p>The publisher did not fund the research. The publisher did not conduct the research. The publisher did not review the research. The publisher charges you to read the results.</p>
          <p>The five largest academic publishers &mdash; <strong>Elsevier, Springer Nature, Wiley, Taylor &amp; Francis, and SAGE</strong> &mdash; control more than half of all published research. Elsevier alone has reported profit margins above 30%, consistently higher than Apple, Google, or Amazon. They are the most profitable gatekeepers in the history of knowledge.</p>
          <p>The researcher who wrote the paper? She cannot access her own published work without paying or going through her university&rsquo;s subscription. If she changes institutions, retires, or her university cuts its journal budget, she loses access to the paper she wrote. Academics routinely email each other PDFs of their own papers because the legitimate access channels are broken.</p>
          <p>This is not a conspiracy. It is a <strong>business model</strong>. The journals are the money changers in the temple &mdash; extracting rent from a public good, standing between the knowledge and the people who paid for it. The universities participate because &ldquo;publish or perish&rdquo; culture gives them no choice: tenure requires publication in prestigious journals, and prestigious journals require copyright transfer. The system feeds itself.</p>
          <p>And then there is the language. Even when you can access the abstracts for free through PubMed, the search interface requires <strong>boolean operators</strong> and <strong>Medical Subject Headings (MeSH)</strong> &mdash; a controlled vocabulary of over 30,000 terms that medical librarians spend years learning. A plain question like &ldquo;does vitamin D help prevent colds?&rdquo; must become:</p>
          <pre class="prompt-display" style="margin:0.75rem 0;">(&quot;Vitamin D&quot;[MeSH] OR &quot;Cholecalciferol&quot;[MeSH]) AND (&quot;Respiratory Tract Infections&quot;[MeSH] OR &quot;Common Cold&quot;[MeSH]) AND (&quot;Prevention and Control&quot;[Subheading] OR &quot;Dietary Supplements&quot;[MeSH])</pre>
          <p>And the papers themselves speak clinical jargon. A study about whether exercise helps depression does not say &ldquo;exercise helps depression.&rdquo; It says: <em>&ldquo;A statistically significant reduction in PHQ-9 scores (mean difference &minus;3.2, 95% CI &minus;4.1 to &minus;2.3, p&lt;0.001) was observed in the intervention group relative to controls at 12-week follow-up.&rdquo;</em></p>
          <p>So the public pays three times. Once through taxes that fund the research. Again through tuition that pays the researchers. And again through paywalls that charge for the results. And even after all that, the language ensures you cannot understand what you paid for.</p>
          <p>The system was not broken. <em>It was built this way.</em></p>
          <p>PubMed offers the abstracts for free. That is the crack in the wall. Tables Turned drives a truck through it.</p>
        </div>

        <!-- Chapter 2: Why Not Just Ask ChatGPT? -->
        <div class="doc-chapter reveal">
          <h2>Why Not Just Ask ChatGPT?</h2>
          <p>You might be thinking: can&rsquo;t AI already do this?</p>
          <p>Sort of. But <em>how</em> it does it matters enormously.</p>
          <p>Google&rsquo;s &ldquo;AI Overviews&rdquo; scan the web and give you a confident summary at the top of search results. No sources you can verify. No way to know what was excluded. No indication of whether the answer came from a peer-reviewed study or a wellness blog.</p>
          <p>ChatGPT will happily discuss medical research. It will cite papers. Some of those citations will be real. Some will be <strong>hallucinated</strong> &mdash; invented paper titles, fabricated authors, made-up findings presented with the same confident tone as the real ones. You have no way to tell which is which without checking every citation yourself.</p>
          <p>These tools treat you as a <strong>consumer of answers</strong>. You ask. They deliver. You accept. Sound familiar?</p>
          <p>It is the same gatekeeping pattern wearing a friendlier mask. The journals said: trust us, we curate the knowledge. The algorithms say: trust us, we summarize it. In both cases, the evidence is not in your hands. You are still on the outside of the glass, trusting an intermediary to get it right.</p>
          <p>Tables Turned takes a different position: you should be in <strong>dialogue with the evidence itself</strong>. Not receiving a verdict. Not consuming a summary. Sitting at the table, choosing which papers matter, reading what they actually say, and walking away with every claim traced to its source.</p>
          <p>The difference between an answer box and a dialogue is the difference between being told what to think and being equipped to think for yourself.</p>
        </div>

        <!-- Chapter 3: The Dialogue -->
        <div class="doc-chapter reveal">
          <h2>The Dialogue</h2>
          <p>Here is how Tables Turned works, step by step.</p>

          <h3>Step 1: You ask a question</h3>
          <p>Type your question in plain English. Add your decision context &mdash; the reason you are asking. &ldquo;Should I give my kid melatonin?&rdquo; is different when the context is &ldquo;they can&rsquo;t sleep before school tomorrow&rdquo; versus &ldquo;building a long-term sleep routine.&rdquo; The context shapes which evidence matters most.</p>

          <h3>Step 2: AI translates your question into PubMed&rsquo;s language</h3>
          <p>Your question is sent to <strong>Claude</strong>, Anthropic&rsquo;s AI. It does not just pull keywords. It generates <strong>multiple search strategies</strong> using real medical terminology &mdash; MeSH headings, boolean operators, synonym expansions &mdash; the same language a medical librarian would use. These strategies range from broad (casting a wide net) to specific (targeting exact conditions and interventions).</p>
          <p>You can see every search term it generated, and why. Nothing is hidden.</p>

          <h3>Step 3: Papers come back in plain language</h3>
          <p>The search terms query PubMed&rsquo;s public API &mdash; the same interface used by researchers and institutions worldwide. Papers return with their titles, authors, journals, years, and abstracts. Then AI translates each paper&rsquo;s title and abstract into plain language &mdash; not dumbed down, but made readable.</p>
          <p>You see both versions: the plain-language translation and the original technical title. <strong>You decide which papers to include.</strong> This is your curation step. The AI does not decide what is relevant. You do.</p>

          <h3>Step 4: AI reads and writes your brief</h3>
          <p>The papers you selected are sent to Claude with strict instructions: separate what the papers observe from what can be inferred. Cite every claim with a PubMed ID. Surface contradictions between papers &mdash; do not hide disagreement. State confidence honestly. Name what is unknown. Flag any claim that cannot be traced to a provided paper as <em>[UNWITNESSED]</em>.</p>
          <p>The synthesis streams in real time. You watch it being written. When it is done, you have a brief you can download as a Word document &mdash; with every claim linked to its source.</p>
          <p>You came in with a question. You leave with receipts.</p>
        </div>

        <!-- Chapter 4: The Prompts -->
        <div class="doc-chapter reveal">
          <h2>The Prompts</h2>
          <p>Every AI interaction in Tables Turned uses a carefully designed prompt. Most AI tools hide their prompts. We show you ours in full, because transparency is not optional when health decisions are at stake.</p>

          <h3>Search Query Generation</h3>
          <p>When you type your question and press search, this prompt converts your plain English into optimized medical database queries with real MeSH headings and boolean logic.</p>
          <pre id="doc-prompt-search" class="prompt-display"></pre>

          <h3>Plain-Language Translation</h3>
          <p>After finding papers, this prompt translates each title and abstract into language anyone can understand &mdash; without losing the substance.</p>
          <pre id="doc-prompt-summary" class="prompt-display"></pre>

          <h3>Synthesis</h3>
          <p>This is the core prompt. It governs how the AI reads the papers and writes your brief. Every rule serves a purpose: separating fact from inference, enforcing citations, surfacing disagreement, preventing hallucination.</p>
          <pre id="doc-prompt-synth" class="prompt-display"></pre>
        </div>

        <!-- Chapter 5: Honest Limits -->
        <div class="doc-chapter reveal">
          <h2>Honest Limits</h2>
          <p>This tool has real limitations. Knowing them makes you a better user.</p>
          <ul>
            <li><strong>Abstracts only.</strong> Tables Turned reads abstracts, not full papers. Abstracts are free and public. Full papers are often paywalled. This means nuance in the methods or results sections may be missed. If a paper matters to your decision, find and read the full text.</li>
            <li><strong>AI can err.</strong> Despite strict instructions, Claude may occasionally misinterpret an abstract or make an unsupported inference. Every claim includes a PMID citation &mdash; click it and read the abstract yourself. The receipts exist so you can verify.</li>
            <li><strong>Not medical advice.</strong> This tool helps you understand what research exists. It does not replace a physician. It gives you better questions to ask your doctor, not answers to follow blindly.</li>
            <li><strong>English-dominant.</strong> PubMed indexes predominantly English-language abstracts. Research published in other languages may not appear.</li>
            <li><strong>Search boundaries.</strong> The AI generates search strategies, but PubMed&rsquo;s index has limits. Very new papers may not be indexed yet. Very niche topics may have little published research. The search stats tell you exactly how many papers were found and how.</li>
          </ul>
        </div>

        <!-- Chapter 6: Technical Details -->
        <div class="doc-chapter reveal">
          <h2>Technical Details</h2>
          <h3>Data source</h3>
          <p><strong>PubMed / NCBI E-utilities:</strong> All paper metadata and abstracts are fetched from the National Center for Biotechnology Information&rsquo;s public API. This is the same database used by researchers, doctors, and institutions worldwide. Free, public, no account required.</p>
          <h3>AI model</h3>
          <p><strong>Claude by Anthropic:</strong> All AI interactions use Claude, Anthropic&rsquo;s most capable model. You provide your own API key, which means your data is sent directly from your browser to Anthropic&rsquo;s servers. Nothing passes through our servers because we do not have servers. This is a static website.</p>
          <h3>Privacy</h3>
          <p>Your API key is stored in your browser&rsquo;s localStorage. It is never sent anywhere except to Anthropic&rsquo;s API. Your questions, papers, and briefs exist only in your browser. When you close the tab, they are gone unless you downloaded them. No tracking. No analytics. No database.</p>
        </div>

        <!-- Chapter 7: The Lineage -->
        <div class="doc-chapter reveal">
          <h2>The Lineage</h2>
          <p>Tables Turned inherits from a long tradition of putting knowledge back in common hands.</p>
          <p>When William Tyndale translated the Bible into English in 1526, he was burned at the stake for it. The gatekeepers of his era argued that scripture was too dangerous for ordinary people &mdash; that only priests could be trusted to interpret the Word.</p>
          <p>When Andrew Carnegie built 2,509 free public libraries across the English-speaking world, he was told the working class would not use them. They did.</p>
          <p>When Aaron Swartz downloaded millions of academic papers from JSTOR and tried to make them freely available, he was prosecuted by the federal government. He died at 26. The papers are still behind paywalls. The publishers are still posting 30% profit margins.</p>
          <p>The pattern is always the same. Knowledge exists. Gatekeepers insist it must be mediated. Translators refuse the premise. Eventually, the public record returns to the public.</p>
          <p>This tool is one small table flip in that tradition. It does not replace reading. It does not replace thinking. It does not replace your physician. It is a translator that sits at the table with you, reads the public record aloud, and makes sure every claim has a receipt.</p>
          <p class="lineage-end">The commons table is set. Pull up a chair.</p>
        </div>

      </div>
    </div>

    <!-- ═══ SETTINGS ═══ -->
    <details id="settings">
      <summary>Settings</summary>
      <div class="settings-inner">
        <div class="field">
          <label for="s-key">API Key</label>
          <input type="password" id="s-key">
        </div>
      </div>
    </details>

    <!-- ═══ FOOTER ═══ -->
    <footer id="site-footer">
      <div class="footer-brand">
        <div class="footer-sigil">&#9674; &#9672; &#9674;</div>
        <div class="footer-title">The Word Against The Flood</div>
      </div>
      <div class="footer-links">
        <a href="mailto:JEThomasPhD@gmail.com">JEThomasPhD@gmail.com</a>
      </div>
      <div class="footer-sig">
        Made using <a href="https://the-companion-dossier.pages.dev/Latent_Dialogic_Space/" target="_blank" rel="noopener">Latent Dialogic Space</a>
      </div>
    </footer>
  </div>

  <script src="js/shoreline.js"></script>
  <script src="js/tablet-press.js"></script>
  <script src="js/synthesis.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
